<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!-- 需要暴露底层实例或外部托管对象的场景，集中抑制 EI/EI2 -->

    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.FetaruteTCAddon"/>
        <Method name="getLoggerManager"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.FetaruteTCAddon"/>
        <Method name="getRailGraphService"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.FetaruteTCAddon"/>
        <Method name="getSignNodeRegistry"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.FetaruteTCAddon"/>
        <Method name="getOccupancyManager"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>

    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.company.model.CompanyMember"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>

    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.utils.LoggerManager"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.utils.LoggerManager"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>

    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.JdbcStorageProvider"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.JdbcStorageProvider"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>

    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.JdbcStorageTransaction"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.JdbcStorageTransaction"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>

    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.JdbcStorageTransactionManager"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>

    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.command.FtaInfoCommand"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.command.FtaRootCommand"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.command.FtaStorageCommand"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.command.FtaDepotCommand"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.command.FtaEtaCommand"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.command.FtaOccupancyCommand"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.command.FtaTrainCommand"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.dispatcher.sign.action.AutoStationSignAction"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.config.ConfigManager"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.dispatcher.sign.SignRemoveListener"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.dispatcher.runtime.RuntimeDispatchListener"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.dispatcher.runtime.RuntimeSignalMonitor"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.dispatcher.runtime.ReclaimManager"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.dispatcher.eta.runtime.EtaRuntimeSampler"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.StorageManager"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.StorageManager"/>
        <Method name="applySchemaIfReady"/>
        <Bug pattern="SQL_NONCONSTANT_STRING_PASSED_TO_EXECUTE"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.utils.ConfigUpdater"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>

    <!-- 使用表前缀动态组装 SQL，表名来自白名单，安全性由代码保证 -->
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcPlayerIdentityRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcCompanyRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcCompanyMemberRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcCompanyMemberInviteRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcOperatorRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcLineRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcRouteRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcRouteStopRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcStationRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcRailNodeRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcRailEdgeRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcRailEdgeOverrideRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcRailGraphSnapshotRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.jdbc.repository.JdbcRailComponentCautionRepository"/>
        <Bug pattern="SQL_PREPARED_STATEMENT_GENERATED_FROM_NONCONSTANT_STRING"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.StorageManager"/>
        <Bug pattern="SQL_NONCONSTANT_STRING_PASSED_TO_EXECUTE"/>
    </Match>

    <!-- 测试夹具在 setUp 中清理测试文件，空值路径已由 JUnit 环境保障 -->
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.JdbcRepositoryTest"/>
        <Method name="setUp"/>
        <Bug pattern="NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE"/>
    </Match>
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.storage.JdbcRepositoryTest"/>
        <Method name="lambda$setUp$0"/>
        <Bug pattern="NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE"/>
    </Match>

    <!-- Mockito static mocking 的 when(...) 使用 void lambda 记录调用，SpotBugs 会误报“忽略返回值”。 -->
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.dispatcher.sign.SwitcherSignDefinitionParserTest"/>
        <Method name="lambda$ignoresTagSignsOnBukkitSign$0"/>
        <Bug pattern="RV_RETURN_VALUE_IGNORED_NO_SIDE_EFFECT"/>
    </Match>

    <!-- BKCommonLib CommonEntity 返回类型的误报：member.getEntity().getEntity() -->
    <Match>
        <Class name="org.fetarute.fetaruteTCAddon.dispatcher.sign.action.AutoStationDoorController"/>
        <Method name="chooseDoorSideByWorld"/>
        <Bug pattern="BC_UNCONFIRMED_CAST_OF_RETURN_VALUE"/>
    </Match>
</FindBugsFilter>
